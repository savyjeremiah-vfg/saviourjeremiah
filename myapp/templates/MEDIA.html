{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Share Your Testimony - RCF</title>
<style>
/* ====== GENERAL ====== */
body {
    font-family: 'Poppins', Arial, sans-serif;
    background: linear-gradient(135deg, #f6d365, #fda085);
    margin: 0; padding: 0;
}
.container { display: flex; flex-direction: column; align-items: center; padding: 60px 20px; }
/* NAVBAR */
.navbar { width:100%; background: rgba(0,0,0,0.7); color: #fff; padding:15px 30px; position:sticky; top:0; display:flex; justify-content:space-between; align-items:center; z-index:100; }
.navbar h1 { margin:0; font-size:24px; }
/* HEADER */
h1 { font-size:40px; color:#fff; margin-bottom:20px; text-align:center; text-shadow:2px 2px 6px rgba(0,0,0,0.3); }
/* FORM */
form { background: rgba(255, 255, 255, 0.95); padding: 40px 30px; border-radius: 20px; max-width: 550px; width:100%; box-shadow:0 15px 35px rgba(0,0,0,0.2); margin-bottom:50px; }
input, textarea { width:100%; padding:14px; margin-bottom:20px; border-radius:10px; border:1px solid #ccc; font-size:16px; }
button { width:100%; padding:16px; background: linear-gradient(45deg, #ff7e5f, #feb47b); border:none; color:white; font-size:18px; border-radius:12px; cursor:pointer; }
button:hover { opacity:0.9; }
/* SUCCESS MESSAGE */
#success-box { padding:15px; background:#c8f7c5; border:2px solid #2ecc71; border-radius:10px; margin-bottom:30px; max-width:550px; width:100%; text-align:center; color:#2a7a2a; }
/* TESTIMONY DISPLAY */
.testimony-container { max-width:900px; width:90%; margin:auto; display:flex; flex-direction:column; gap:25px; }
.testimonial { position:relative; background: rgba(255,255,255,0.95); border-radius:20px; padding:25px 25px 25px 140px; box-shadow:0 12px 24px rgba(0,0,0,0.15); }
.testimonial img { position:absolute; top:25px; left:25px; width:90px; height:90px; border-radius:50%; object-fit:cover; border:3px solid #ff7e5f; }
.testimonial h3 { margin:0; font-size:22px; font-weight:bold; }
.testimonial small { color:#444; display:block; margin-bottom:10px; }
.testimonial p { font-size:17px; color:#222; line-height:1.5; white-space:pre-wrap; }
.delete-btn { margin-top:10px; padding:8px 12px; background:#e74c3c; color:white; border:none; border-radius:5px; font-weight:bold; cursor:pointer; }
.delete-btn:hover { background:#c0392b; }
@media(max-width:700px) { .testimonial { padding-left:120px; } .testimonial img { width:75px; height:75px; } }
@media(max-width:500px) { .testimonial { padding-left:100px; padding-top:30px; } .testimonial img { width:60px; height:60px; } }
</style>
</head>
<body>

<div class="navbar">
    <h1>RCF Website</h1>
    <nav>{% include "nav.html" %}</nav>
</div>

<div class="container">
    <h1>Share Your Testimony</h1>

    {% if messages %}
        <div id="success-box">
            {% for m in messages %}{{ m }}{% endfor %}
        </div>
    {% endif %}

    <form action="{% url 'MEDIA' %}" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="text" name="name" placeholder="Your Name" required>
        <textarea name="message" placeholder="Write your testimony..." rows="6" required></textarea>
        <input type="file" name="image">
        <button type="submit">Submit Testimony</button>
    </form>
</div>

<div class="testimony-container">
    {% for t in testimonies %}
    <div class="testimonial">
        {% if t.image %}
            <img src="{{ t.image.url }}" alt="{{ t.name }}">
        {% else %}
            <img src="{% static 'default-profile.jpg' %}" alt="{{ t.name }}">
        {% endif %}
        <h3>{{ t.name }}</h3>
        <small>{{ t.created_at|date:"M d, Y H:i" }}</small>
        <p>{{ t.message }}</p>

        {% if user.is_authenticated %}
            <form action="{% url 'delete_testimony' t.id %}" method="POST">
                {% csrf_token %}
                <button type="submit" class="delete-btn">Delete</button>
            </form>
        {% endif %}
    </div>
    {% empty %}
        <p style="font-weight:bold; color:#111;">No testimonies yet.</p>
    {% endfor %}
</div>

</body>
</html>
